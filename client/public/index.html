<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toronto Weekly Events Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Onest:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --dark-purple: #310a31;
            --dark-purple-light: #4a1449;
            --slate-gray: #6d8a96;
            --slate-gray-light: #8ca6b2;
            --white-smoke: #f5f5f5;
            --paynes-gray: #5d707f;
            --auburn: #a52a2a;
            --auburn-light: #c73e3e;
            --golden-yellow: #ffd700;
            --asparagus: #87a96b;
            --asparagus-dark: #6f8a51;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Onest', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--white-smoke);
            color: var(--dark-purple);
            line-height: 1.6;
            font-size: 14px;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        header {
            padding: 20px 24px;
            background: var(--white-smoke);
            border-bottom: 2px solid var(--dark-purple);
        }

        header h1 {
            font-family: 'Instrument Serif', serif;
            font-size: 2.5rem;
            font-weight: 400;
            color: var(--auburn);
            margin-bottom: 4px;
        }

        header p {
            font-size: 0.85rem;
            color: var(--paynes-gray);
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding: 20px 24px;
            background: var(--white-smoke);
            border-bottom: 1px solid var(--slate-gray-light);
        }

        .slider-container {
            width: 100%;
        }

        .slider-label {
            font-family: 'Instrument Serif', serif;
            font-size: 1.5rem;
            color: var(--dark-purple);
            text-align: center;
            margin-bottom: 12px;
        }

        .slider-label .day {
            color: var(--auburn);
        }

        .slider-label .time {
            font-style: italic;
            color: var(--paynes-gray);
        }

        .time-slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right,
                var(--asparagus) 0%, var(--asparagus) 14.28%,
                var(--slate-gray) 14.28%, var(--slate-gray) 28.57%,
                var(--auburn) 28.57%, var(--auburn) 42.85%,
                var(--asparagus) 42.85%, var(--asparagus) 57.14%,
                var(--slate-gray) 57.14%, var(--slate-gray) 71.42%,
                var(--auburn) 71.42%, var(--auburn) 85.71%,
                var(--asparagus) 85.71%, var(--asparagus) 100%
            );
            border-radius: 4px;
            outline: none;
            cursor: pointer;
        }

        .time-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: var(--dark-purple);
            border: 3px solid var(--white-smoke);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(49, 10, 49, 0.3);
            transition: transform 0.15s ease;
        }

        .time-slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }

        .time-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: var(--dark-purple);
            border: 3px solid var(--white-smoke);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(49, 10, 49, 0.3);
        }

        .slider-ticks {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 0.7rem;
            color: var(--paynes-gray);
        }

        .slider-ticks span {
            text-align: center;
            width: 40px;
        }

        .controls-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .event-count {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--paynes-gray);
        }

        .event-count strong {
            font-family: 'Instrument Serif', serif;
            color: var(--auburn);
            font-size: 2rem;
            font-weight: 400;
        }

        #map {
            flex: 1;
            min-height: 400px;
        }

        .leaflet-popup-content-wrapper {
            background: var(--white-smoke);
            color: var(--dark-purple);
            border-radius: 12px;
            padding: 0;
            border: 2px solid var(--dark-purple);
            box-shadow: 0 4px 12px rgba(49, 10, 49, 0.15);
        }

        .leaflet-popup-content {
            margin: 0;
            min-width: 260px;
        }

        .leaflet-popup-tip {
            background: var(--white-smoke);
            border: 2px solid var(--dark-purple);
            border-top: none;
            border-left: none;
        }

        .popup-content {
            padding: 16px;
        }

        .popup-content h3 {
            font-family: 'Instrument Serif', serif;
            font-size: 1.4rem;
            font-weight: 400;
            margin-bottom: 8px;
            color: var(--dark-purple);
        }

        .popup-content .venue {
            font-size: 0.85rem;
            color: var(--auburn);
            font-weight: 600;
            margin-bottom: 4px;
        }

        .popup-content .address {
            font-size: 0.75rem;
            color: var(--paynes-gray);
            margin-bottom: 10px;
        }

        .popup-content .time-badge {
            display: inline-block;
            padding: 5px 10px;
            background: var(--dark-purple);
            color: white;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .popup-content .description {
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--dark-purple);
            line-height: 1.5;
        }

        .popup-content a {
            color: var(--auburn);
            text-decoration: none;
        }

        .popup-content a:hover {
            text-decoration: underline;
        }

        footer {
            padding: 14px 24px;
            background: var(--white-smoke);
            border-top: 2px solid var(--dark-purple);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: var(--paynes-gray);
            flex-wrap: wrap;
            gap: 8px;
        }

        footer a {
            color: var(--auburn);
            text-decoration: none;
            font-weight: 600;
        }

        footer a:hover {
            text-decoration: underline;
        }

        .footer-links {
            display: flex;
            gap: 16px;
        }

        .no-events {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--white-smoke);
            padding: 32px;
            border-radius: 12px;
            text-align: center;
            z-index: 1000;
            border: 2px solid var(--dark-purple);
            box-shadow: 0 4px 16px rgba(49, 10, 49, 0.2);
        }

        .no-events h3 {
            font-family: 'Instrument Serif', serif;
            margin-bottom: 8px;
            color: var(--dark-purple);
            font-weight: 400;
            font-size: 1.5rem;
        }

        .no-events p {
            color: var(--paynes-gray);
            font-size: 0.85rem;
        }

        @media (max-width: 640px) {
            header h1 {
                font-size: 2rem;
            }

            .slider-label {
                font-size: 1.25rem;
            }

            .controls {
                padding: 16px;
            }

            header {
                padding: 14px 16px;
            }

            .slider-ticks {
                font-size: 0.6rem;
            }

            .slider-ticks span {
                width: 30px;
            }

            footer {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Toronto Weekly Events</h1>
            <p>Recurring community events happening every week</p>
        </header>

        <div class="controls">
            <div class="slider-container">
                <div class="slider-label">
                    <span class="day" id="current-day">Monday</span> <span class="time" id="current-time">Morning</span>
                </div>
                <input type="range" min="0" max="20" value="0" class="time-slider" id="time-slider">
                <div class="slider-ticks">
                    <span>Mon</span>
                    <span>Tue</span>
                    <span>Wed</span>
                    <span>Thu</span>
                    <span>Fri</span>
                    <span>Sat</span>
                    <span>Sun</span>
                </div>
            </div>
            <div class="controls-row">
                <div class="event-count">
                    <span>Showing</span>
                    <strong id="count">0</strong>
                    <span>events</span>
                </div>
            </div>
        </div>

        <div id="map"></div>

        <div id="no-events-msg" class="no-events" style="display: none;">
            <h3>No events at this time</h3>
            <p>Try sliding to a different day or time</p>
        </div>

        <footer>
            <span>Data from <a href="https://t0ronto.ca" target="_blank">t0ronto.ca</a> · Made by <a href="https://x.com/earnestpost" target="_blank">Erin Saint Gull</a> · <a href="https://curate.beauty" target="_blank">curate.beauty</a></span>
            <div class="footer-links">
                <a href="/old-calendar.html">Old layout</a>
                <a href="/about.html">About</a>
            </div>
        </footer>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Weekly events data - all addresses verified via web search Dec 2024
        const weeklyEvents = [
            // MONDAY
            {
                name: "Tech Pizza Mondays",
                venue: "Victory Cafe",
                address: "440 Bloor St W, Toronto, ON M5S 1X5",
                lat: 43.6652,
                lng: -79.4097,
                day: "monday",
                timeSlot: "evening",
                time: "6:00 PM",
                description: "Weekly tech meetup with pizza. Meet founders, developers, and tech enthusiasts.",
                url: "https://mondays.pizza"
            },
            {
                name: "Art Bar Poetry Series",
                venue: "Free Times Cafe",
                address: "320 College St, Toronto, ON M5T 1S3",
                lat: 43.6579,
                lng: -79.4050,
                day: "monday",
                timeSlot: "evening",
                time: "Evening",
                description: "Canada's longest-running poetry-only weekly reading series."
            },
            {
                name: "Open Mic Night",
                venue: "The Painted Lady",
                address: "218 Ossington Ave, Toronto, ON M6J 2Z9",
                lat: 43.6484,
                lng: -79.4247,
                day: "monday",
                timeSlot: "evening",
                time: "8:00 PM",
                description: "Hosted by Kunle. Sign up at 8pm sharp. Two songs per performer, all genres welcome.",
                url: "https://thepaintedlady.ca"
            },
            {
                name: "Jazz Trios Night",
                venue: "The Emmet Ray",
                address: "924 College St, Toronto, ON M6H 1A4",
                lat: 43.6543,
                lng: -79.4270,
                day: "monday",
                timeSlot: "evening",
                time: "Evening",
                description: "Live jazz trio performances at Toronto's beloved whisky bar. 230+ whiskies available.",
                url: "https://theemmetray.com"
            },
            {
                name: "Reading Rhythms Toronto",
                venue: "Duke of York",
                address: "39 Prince Arthur Ave, Toronto, ON M5R 1B2",
                lat: 43.6687,
                lng: -79.3951,
                day: "monday",
                timeSlot: "evening",
                time: "7:00 - 9:00 PM",
                description: "Social reading parties designed to make it easy for people to gather and read together."
            },
            {
                name: "Chess Night",
                venue: "Rooms (915 Dupont)",
                address: "915 Dupont St, Toronto, ON M6H 1Z1",
                lat: 43.6687,
                lng: -79.4334,
                day: "monday",
                timeSlot: "evening",
                time: "6:00 - 11:00 PM",
                description: "Jazz & Chess nights at Toronto's listening bar. Bring your own board or join a game. Notable chess personalities have played here during FIDE events.",
                url: "https://www.corner.inc/place/61105"
            },
            {
                name: "Monday Trivia",
                venue: "Pour Boy",
                address: "666 Manning Ave, Toronto, ON M6G 2W4",
                lat: 43.6647,
                lng: -79.4166,
                day: "monday",
                timeSlot: "evening",
                time: "8:00 PM",
                description: "Weekly trivia night. $10/team entry fee donated to a children's center in Ghana. Cash only venue with Asian fusion pub food.",
                url: "https://pourboy.ca"
            },
            {
                name: "Vinyl Night (BYOV)",
                venue: "Communist's Daughter",
                address: "1149 Dundas St W, Toronto, ON M6J 1X3",
                lat: 43.6501,
                lng: -79.4291,
                day: "monday",
                timeSlot: "evening",
                time: "5:00 PM onwards",
                description: "Bring your own vinyl night. After listening to a record's A-side, patrons debate whether to flip it over. A Dundas West dive bar staple since 2003.",
                url: "https://communists-daughter.edan.io"
            },
            {
                name: "Jazz Rat Mondays",
                venue: "Dina's Tavern",
                address: "486 Spadina Ave, Toronto, ON M5S 2H1",
                lat: 43.6571,
                lng: -79.4003,
                day: "monday",
                timeSlot: "evening",
                time: "Doors 6:00 PM, Music 8:30 PM",
                description: "Jazz night with Patrick Smith & Co. $10 martinis all night. Located in the historic former Silver Dollar Room space near Spadina & College.",
                url: "https://www.dinastavern.com"
            },

            // TUESDAY
            {
                name: "Civic Tech Toronto",
                venue: "Myhal Centre (rotating)",
                address: "55 St. George St, Toronto, ON M5S 0C9",
                lat: 43.6603,
                lng: -79.3968,
                day: "tuesday",
                timeSlot: "evening",
                time: "6:30 PM",
                description: "Hacknight format meetup focused on civic tech challenges. Vibrant and diverse community.",
                url: "https://civictech.ca"
            },
            {
                name: "Hacklab Open House",
                venue: "Hacklab Toronto",
                address: "1677 St Clair Ave W, Toronto, ON M6N 1H9",
                lat: 43.6768,
                lng: -79.4556,
                day: "tuesday",
                timeSlot: "evening",
                time: "6:00 PM",
                description: "Toronto's hacker collective opens their doors. Show off projects, ask for help, or help others.",
                url: "https://hacklab.to"
            },
            {
                name: "Tuesday Open Mic",
                venue: "Free Times Cafe",
                address: "320 College St, Toronto, ON M5T 1S3",
                lat: 43.6579,
                lng: -79.4050,
                day: "tuesday",
                timeSlot: "evening",
                time: "6:30 PM",
                description: "Weekly open mic night at Toronto's 45-year-old cultural institution.",
                url: "https://freetimescafe.com"
            },
            {
                name: "Open Mic Night",
                venue: "Handlebar",
                address: "159 Augusta Ave, Toronto, ON M5T 2L4",
                lat: 43.6542,
                lng: -79.4016,
                day: "tuesday",
                timeSlot: "evening",
                time: "8:30 PM",
                description: "The best open mic in town. Sign up at 8pm. In the heart of Kensington Market.",
                url: "https://thehandlebar.ca"
            },
            {
                name: "AI Policy Tuesdays",
                venue: "Trajectory Labs",
                address: "30 Adelaide St E, 12th Floor, Toronto, ON M5C 2C5",
                lat: 43.6511,
                lng: -79.3773,
                day: "tuesday",
                timeSlot: "evening",
                time: "6:00 - 9:00 PM",
                description: "Weekly meetup exploring AI policy topics. Part of Toronto's AI safety community at Trajectory Labs coworking space.",
                url: "https://lu.ma/trajectory-labs"
            },
            {
                name: "Sapphic Tuesdays",
                venue: "Bampot House",
                address: "201 Harbord St, Toronto, ON M5S 1H6",
                lat: 43.6615,
                lng: -79.4091,
                day: "tuesday",
                timeSlot: "evening",
                time: "Evening",
                description: "Weekly sapphic community events including Sapphic Salon, craft nights, open mic, and live music. Pay-by-the-hour anti-cafe with unlimited tea.",
                url: "https://bampottea.com"
            },
            {
                name: "Trivia Night",
                venue: "Duke of York",
                address: "39 Prince Arthur Ave, Toronto, ON M5R 1B2",
                lat: 43.6687,
                lng: -79.3951,
                day: "tuesday",
                timeSlot: "evening",
                time: "7:00 PM",
                description: "One of Toronto's favourite pub trivia nights with witty quiz masters. Great selection of craft beers on tap. Oldest English pub in Toronto.",
                url: "https://dukepubs.ca/duke-of-york/"
            },
            {
                name: "General Trivia",
                venue: "Snakes & Lattes Annex",
                address: "600 Bloor St W, Toronto, ON M6G 1K4",
                lat: 43.6647,
                lng: -79.4139,
                day: "tuesday",
                timeSlot: "evening",
                time: "7:00 - 9:00 PM",
                description: "Weekly trivia covering music, movies, TV, celebrities, sports, food, games and more. Board game cafe with 1000+ games.",
                url: "https://www.snakesandlattes.com/annex"
            },

            // WEDNESDAY
            {
                name: "Punch Up Comedy",
                venue: "The Emmet Ray",
                address: "924 College St, Toronto, ON M6H 1A4",
                lat: 43.6543,
                lng: -79.4270,
                day: "wednesday",
                timeSlot: "evening",
                time: "6:00 PM",
                description: "Weekly stand-up comedy open mic. List starts at 5:30pm."
            },
            {
                name: "Beyond B-SIDE Open Mic",
                venue: "TheMix669",
                address: "669 College St, Toronto, ON M6G 1B9",
                lat: 43.6550,
                lng: -79.4182,
                day: "wednesday",
                timeSlot: "evening",
                time: "8:00 PM",
                description: "The spiritual successor of the Wednesday open mic at B-Side. All genres welcome."
            },
            {
                name: "Kinetic",
                venue: "The Painted Lady",
                address: "218 Ossington Ave, Toronto, ON M6J 2Z9",
                lat: 43.6484,
                lng: -79.4247,
                day: "wednesday",
                timeSlot: "evening",
                time: "9:00 PM",
                description: "Free Wednesday night techno. Not-for-profit community dance party by The Future Underground. Local DJs and electronic producers. 19+.",
                url: "https://thepaintedlady.ca"
            },
            {
                name: "Chess Night",
                venue: "Danu Social House",
                address: "1237 Queen St W, Toronto, ON M6K 1L5",
                lat: 43.6394,
                lng: -79.4344,
                day: "wednesday",
                timeSlot: "evening",
                time: "6:00 - 11:00 PM",
                description: "Chess night for everyone—no experience necessary. Boards provided. Come alone or bring a friend. Community bar in Parkdale.",
                url: "https://www.danusocialhouse.ca"
            },
            {
                name: "Social Game Night",
                venue: "Snakes & Lattes College",
                address: "489 College St, Toronto, ON M6G 1A5",
                lat: 43.6556,
                lng: -79.4109,
                day: "wednesday",
                timeSlot: "evening",
                time: "Evening",
                description: "Unplug, unwind, meet new people over board games. $20 admission includes unlimited non-alcoholic drinks. Toronto's original board game cafe.",
                url: "https://www.snakesandlattes.com/college"
            },
            {
                name: "Trivia Night",
                venue: "The Drake Hotel",
                address: "1150 Queen St W, Toronto, ON M6J 1J3",
                lat: 43.6434,
                lng: -79.4279,
                day: "wednesday",
                timeSlot: "evening",
                time: "8:00 PM",
                description: "One of the harder trivia nights in the city. Topics change weekly. $5 to play, winning table gets $100 Drake gift card.",
                url: "https://thedrake.ca"
            },

            // THURSDAY
            {
                name: "Ecstatic Dance Toronto",
                venue: "Sts Cyril & Methody Church",
                address: "237 Sackville St, Toronto, ON M5A 3G1",
                lat: 43.6597,
                lng: -79.3624,
                day: "thursday",
                timeSlot: "evening",
                time: "7:30 PM",
                description: "Toronto's leading weekly Ecstatic Dance. 900+ dances since 2006. Nonverbal, barefoot, alcohol-free.",
                url: "https://ecstaticdance.ca"
            },
            {
                name: "Organic Farmers' Market",
                venue: "Dufferin Grove Park",
                address: "875 Dufferin St, Toronto, ON M6H 3K8",
                lat: 43.6566,
                lng: -79.4358,
                day: "thursday",
                timeSlot: "afternoon",
                time: "3:00 - 7:00 PM",
                description: "Toronto's oldest organic farmers' market. Year-round local and organic produce since 2002.",
                url: "https://dufferingrovemarket.ca"
            },
            {
                name: "AI Safety Thursdays",
                venue: "Trajectory Labs",
                address: "30 Adelaide St E, 12th Floor, Toronto, ON M5C 2C5",
                lat: 43.6511,
                lng: -79.3773,
                day: "thursday",
                timeSlot: "evening",
                time: "6:00 - 9:00 PM",
                description: "Weekly meetup focused on AI safety research and discussion. Part of Toronto's AI alignment community.",
                url: "https://lu.ma/trajectory-labs"
            },
            {
                name: "Karaoke Night",
                venue: "The Monarch Tavern",
                address: "12 Clinton St, Toronto, ON M6J 2N8",
                lat: 43.6502,
                lng: -79.4154,
                day: "thursday",
                timeSlot: "evening",
                time: "10:00 PM - 2:00 AM",
                description: "Karaoke w/ Steve-Oh every Thursday. $5 tall cans and cheap cider specials. Historic bar since 1927 in Little Italy.",
                url: "https://www.themonarchtavern.com"
            },
            {
                name: "Trivia Night",
                venue: "The Fortunate Fox",
                address: "280 Bloor St W, Toronto, ON M5S 1V8",
                lat: 43.6674,
                lng: -79.4028,
                day: "thursday",
                timeSlot: "evening",
                time: "7:00 - 9:00 PM",
                description: "10 trivia categories testing pop culture knowledge. $14 cocktails. Hip gastropub in the Kimpton Saint George Hotel.",
                url: "https://thefortunatefox.com"
            },

            // FRIDAY
            {
                name: "Office Hours",
                venue: "Victory Cafe",
                address: "440 Bloor St W, Toronto, ON M5S 1X5",
                lat: 43.6652,
                lng: -79.4097,
                day: "friday",
                timeSlot: "evening",
                time: "6:30 PM",
                description: "Weekly public gathering for networking and connection. Meet interesting people from the internet.",
                url: "https://officehours.bar"
            },
            {
                name: "Jazz & Blues Night",
                venue: "The Emmet Ray",
                address: "924 College St, Toronto, ON M6H 1A4",
                lat: 43.6543,
                lng: -79.4270,
                day: "friday",
                timeSlot: "evening",
                time: "Evening",
                description: "Live music every Friday at the whisky bar. Over 230 whiskies available.",
                url: "https://theemmetray.com"
            },
            {
                name: "Live Music & Comedy",
                venue: "TRANZAC",
                address: "292 Brunswick Ave, Toronto, ON M5S 2M7",
                lat: 43.6647,
                lng: -79.4082,
                day: "friday",
                timeSlot: "evening",
                time: "Evening",
                description: "Not-for-profit venue with diverse music, theatre, and dance. 1400+ events per year.",
                url: "https://tranzac.org"
            },
            {
                name: "Toronto Dance Fridays",
                venue: "Dovercourt House",
                address: "805 Dovercourt Rd, Toronto, ON M6H 2X4",
                lat: 43.6614,
                lng: -79.4319,
                day: "friday",
                timeSlot: "evening",
                time: "7:30 PM - 3:00 AM",
                description: "Latin dance social for salsa, bachata, and kizomba. Lessons 8-10pm, social dancing until 3am. Multiple dance floors and live DJs.",
                url: "https://torontodancefridays.com"
            },

            // SATURDAY
            {
                name: "The Mindful Miles",
                venue: "Various (starts near Eaton Centre)",
                address: "220 Yonge St, Toronto, ON M5B 2H1",
                lat: 43.6543,
                lng: -79.3807,
                day: "saturday",
                timeSlot: "morning",
                time: "8:00 AM",
                description: "Walk 10k-ish steps with wandering conversations. Curious, friendly people meeting up every Saturday."
            },
            {
                name: "The Joy of Writing Together",
                venue: "Aura Concourse Shopping Mall",
                address: "384 Yonge St, Toronto, ON M5B 1S8",
                lat: 43.6588,
                lng: -79.3824,
                day: "saturday",
                timeSlot: "morning",
                time: "10:30 - 11:45 AM",
                description: "Writing session in two groups (reflect or create). Follows The Mindful Miles walk."
            },
            {
                name: "Farmers' Market",
                venue: "Evergreen Brick Works",
                address: "550 Bayview Ave, Toronto, ON M4W 3X8",
                lat: 43.6847,
                lng: -79.3655,
                day: "saturday",
                timeSlot: "morning",
                time: "9:00 AM - 1:00 PM",
                description: "Toronto's largest year-round farmers market. 100+ local vendors within 205km radius.",
                url: "https://evergreen.ca"
            },
            {
                name: "Farmers' Market",
                venue: "St. Lawrence Market North",
                address: "92-95 Front St E, Toronto, ON M5E 1C3",
                lat: 43.6487,
                lng: -79.3715,
                day: "saturday",
                timeSlot: "morning",
                time: "5:00 AM - 3:00 PM",
                description: "Historic market operating since 1803. Once named world's best food market by National Geographic."
            },
            {
                name: "Underground Night Market",
                venue: "Harbourfront Centre",
                address: "235 Queens Quay W, Toronto, ON M5J 2G8",
                lat: 43.6389,
                lng: -79.3819,
                day: "saturday",
                timeSlot: "evening",
                time: "7:00 - 11:00 PM",
                description: "Food stalls, artisan vendors, live DJs. Free entry, food/drinks $10 or less."
            },
            {
                name: "Social Game Night",
                venue: "Snakes & Lattes Annex",
                address: "600 Bloor St W, Toronto, ON M6G 1K4",
                lat: 43.6647,
                lng: -79.4139,
                day: "saturday",
                timeSlot: "evening",
                time: "Evening",
                description: "Unplug, unwind, and meet new people over board games. Toronto's original board game cafe.",
                url: "https://snakesandlattes.com"
            },
            {
                name: "Live Music & Comedy",
                venue: "TRANZAC",
                address: "292 Brunswick Ave, Toronto, ON M5S 2M7",
                lat: 43.6647,
                lng: -79.4082,
                day: "saturday",
                timeSlot: "evening",
                time: "Evening",
                description: "Not-for-profit venue with diverse music, theatre, and dance.",
                url: "https://tranzac.org"
            },

            // SUNDAY
            {
                name: "Shut Up & Code",
                venue: "Au Pain Doré Bakery",
                address: "81 Front St E, Toronto, ON M5E 1B8",
                lat: 43.6479,
                lng: -79.3735,
                day: "sunday",
                timeSlot: "morning",
                time: "9:15 - 11:15 AM",
                description: "Focused silent coding sessions with networking. For coders of all skill levels in a distraction-free environment."
            },
            {
                name: "Sunday Contact Jam",
                venue: "Dovercourt House",
                address: "805 Dovercourt Rd, Toronto, ON M6H 2X4",
                lat: 43.6614,
                lng: -79.4319,
                day: "sunday",
                timeSlot: "morning",
                time: "10:30 AM - 1:30 PM",
                description: "Running continuously for 35+ years. Contact improvisation dance community.",
                url: "https://torontodance.com"
            },
            {
                name: "Sunday Salsa vs Bachata",
                venue: "Dovercourt House",
                address: "805 Dovercourt Rd, Toronto, ON M6H 2X4",
                lat: 43.6614,
                lng: -79.4319,
                day: "sunday",
                timeSlot: "evening",
                time: "6:00 - 11:00 PM",
                description: "Weekly Latin dance social. Bachata lessons at 6pm, salsa lessons at 6:45pm, social dancing until 11pm across two rooms.",
                url: "https://torontodancefridays.com"
            },
            {
                name: "Open Mic Jam",
                venue: "Function Bar + Kitchen",
                address: "473 Church St, Toronto, ON M4Y 2C5",
                lat: 43.6636,
                lng: -79.3800,
                day: "sunday",
                timeSlot: "evening",
                time: "7:00 PM",
                description: "Collaborative space for musicians. All genres welcome from jazz to rock to hip-hop.",
                url: "https://functionbar.ca"
            },
            {
                name: "Sunday Klezmer Brunch",
                venue: "Free Times Cafe",
                address: "320 College St, Toronto, ON M5T 1S3",
                lat: 43.6579,
                lng: -79.4050,
                day: "sunday",
                timeSlot: "morning",
                time: "11:00 AM",
                description: "Live klezmer music with brunch. A Toronto tradition at the 45-year institution.",
                url: "https://freetimescafe.com"
            },
            {
                name: "Antique Market",
                venue: "St. Lawrence Market North",
                address: "92-95 Front St E, Toronto, ON M5E 1C3",
                lat: 43.6487,
                lng: -79.3715,
                day: "sunday",
                timeSlot: "morning",
                time: "Dawn - 5:00 PM",
                description: "Over 80 vendors with antiques, collectibles, and vintage finds."
            }
        ];

        // Slider configuration: 21 positions (7 days × 3 time slots)
        const sliderConfig = [
            { day: 'monday', time: 'morning', label: 'Monday', timeLabel: 'Morning' },
            { day: 'monday', time: 'afternoon', label: 'Monday', timeLabel: 'Afternoon' },
            { day: 'monday', time: 'evening', label: 'Monday', timeLabel: 'Evening' },
            { day: 'tuesday', time: 'morning', label: 'Tuesday', timeLabel: 'Morning' },
            { day: 'tuesday', time: 'afternoon', label: 'Tuesday', timeLabel: 'Afternoon' },
            { day: 'tuesday', time: 'evening', label: 'Tuesday', timeLabel: 'Evening' },
            { day: 'wednesday', time: 'morning', label: 'Wednesday', timeLabel: 'Morning' },
            { day: 'wednesday', time: 'afternoon', label: 'Wednesday', timeLabel: 'Afternoon' },
            { day: 'wednesday', time: 'evening', label: 'Wednesday', timeLabel: 'Evening' },
            { day: 'thursday', time: 'morning', label: 'Thursday', timeLabel: 'Morning' },
            { day: 'thursday', time: 'afternoon', label: 'Thursday', timeLabel: 'Afternoon' },
            { day: 'thursday', time: 'evening', label: 'Thursday', timeLabel: 'Evening' },
            { day: 'friday', time: 'morning', label: 'Friday', timeLabel: 'Morning' },
            { day: 'friday', time: 'afternoon', label: 'Friday', timeLabel: 'Afternoon' },
            { day: 'friday', time: 'evening', label: 'Friday', timeLabel: 'Evening' },
            { day: 'saturday', time: 'morning', label: 'Saturday', timeLabel: 'Morning' },
            { day: 'saturday', time: 'afternoon', label: 'Saturday', timeLabel: 'Afternoon' },
            { day: 'saturday', time: 'evening', label: 'Saturday', timeLabel: 'Evening' },
            { day: 'sunday', time: 'morning', label: 'Sunday', timeLabel: 'Morning' },
            { day: 'sunday', time: 'afternoon', label: 'Sunday', timeLabel: 'Afternoon' },
            { day: 'sunday', time: 'evening', label: 'Sunday', timeLabel: 'Evening' }
        ];

        // Initialize map centered on Toronto
        const map = L.map('map', {
            center: [43.6570, -79.4100],
            zoom: 13,
            zoomControl: true
        });

        // Light map tiles (Voyager style)
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        // Custom marker icon
        function createMarkerIcon(color) {
            return L.divIcon({
                className: 'custom-marker',
                html: `<svg width="30" height="40" viewBox="0 0 30 40" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 0C6.716 0 0 6.716 0 15c0 8.284 15 25 15 25s15-16.716 15-25C30 6.716 23.284 0 15 0z" fill="${color}"/>
                    <circle cx="15" cy="14" r="6" fill="white"/>
                </svg>`,
                iconSize: [30, 40],
                iconAnchor: [15, 40],
                popupAnchor: [0, -40]
            });
        }

        const markers = L.layerGroup().addTo(map);

        // Get current slider position based on current day/time
        function getCurrentSliderPosition() {
            const days = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
            const today = days[new Date().getDay()];
            const currentHour = new Date().getHours();
            let currentTimeSlot = 'morning';
            if (currentHour >= 14) currentTimeSlot = 'afternoon';
            if (currentHour >= 18) currentTimeSlot = 'evening';

            return sliderConfig.findIndex(s => s.day === today && s.time === currentTimeSlot);
        }

        function updateMarkers(sliderValue) {
            markers.clearLayers();

            const config = sliderConfig[sliderValue];
            const selectedDay = config.day;
            const selectedTime = config.time;

            // Update label
            document.getElementById('current-day').textContent = config.label;
            document.getElementById('current-time').textContent = config.timeLabel;

            let filteredEvents = weeklyEvents.filter(e =>
                e.day === selectedDay && e.timeSlot === selectedTime
            );

            // Update count
            document.getElementById('count').textContent = filteredEvents.length;

            // Show/hide no events message
            document.getElementById('no-events-msg').style.display = filteredEvents.length === 0 ? 'block' : 'none';

            // Color based on time slot (Toronto calendar palette)
            const colors = {
                morning: '#87a96b',    // asparagus (green)
                afternoon: '#6d8a96',  // slate-gray
                evening: '#a52a2a'     // auburn (red-brown)
            };

            filteredEvents.forEach(event => {
                const color = colors[event.timeSlot] || '#6d8a96';
                const marker = L.marker([event.lat, event.lng], {
                    icon: createMarkerIcon(color)
                });

                const popupContent = `
                    <div class="popup-content">
                        <h3>${event.name}</h3>
                        <div class="venue">${event.venue}</div>
                        <div class="address">${event.address}</div>
                        <span class="time-badge">${event.time}</span>
                        <div class="description">${event.description}</div>
                        ${event.url ? `<div style="margin-top: 8px;"><a href="${event.url}" target="_blank" style="color: var(--auburn); font-size: 0.75rem;">${event.url}</a></div>` : ''}
                    </div>
                `;

                marker.bindPopup(popupContent);
                markers.addLayer(marker);
            });

            // Fit bounds if we have markers
            if (filteredEvents.length > 0) {
                const group = new L.featureGroup(markers.getLayers());
                map.fitBounds(group.getBounds().pad(0.1));
            }
        }

        // Slider event handler
        const slider = document.getElementById('time-slider');
        slider.addEventListener('input', (e) => {
            updateMarkers(parseInt(e.target.value));
        });

        // Initialize with current day/time
        const initialPosition = getCurrentSliderPosition();
        slider.value = initialPosition >= 0 ? initialPosition : 0;
        updateMarkers(slider.value);
    </script>
</body>
</html>
